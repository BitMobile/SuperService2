<?xml version="1.0" encoding="utf-8"?>

<c:Screen xmlns:c="BitMobile.ClientModel3.UI" xmlns:s="BitMobile.ValueStack">
  <c:DockLayout CssClass="RootLayout">

    <!-- Добавление верхней панели -->
    <s:Include File="Components\TopInfoComponent.xml" />

    <!-- Tab Bar-->
    <s:Include File="Components\TabBarСomponent.xml" />

    <!-- Main SVL-->
    <c:SwipeVerticalLayout CssClass="EventListMainSVL">

      <s:Push Id="EventListLastDate" Value="$GetDateNowEventList()" />
      <s:Push Id="EventListCurrentDate" Value="$GetDateNowEventList()" />
      <s:Iterator Id="EventList" Value="$GetEvents()">

        <!-- Проверка на необходимость плашки "Сегодня" -->
        <s:If Test="$IsTodayLayoutNeed()">

          <s:If Test="$IsDateEqualsOrLess($EventListCurrentDate, $EventList.startDatePlanDate)">
            <c:HorizontalLayout CssClass="EventListDateHL">
              <c:TextView Text="#todayUpper#" CssClass="EventListDateTV" />
            </c:HorizontalLayout>
            <c:HorizontalLine CssClass="EventListLongBreaker" />

          </s:If>
          <s:Push Id="void" Value="$SetTodayLayoutToFalse()" />
        </s:If>
        <!-- Конец проверки на необходимость плашки "Сегодня" -->

        <!-- Проверка на необходимость плашки с датой и брейкера-->
        <s:If Test="$IsDateEqualsOrLess($EventListCurrentDate, $EventList.startDatePlanDate)">
          <!--<c:HorizontalLine CssClass="EventListLongBreaker" />-->

          <!--<c:HorizontalLayout CssClass="EventListDateHL">
            <c:TextView Text="$DateTimeToDateWithWeekCheck($EventList.startDatePlanDate)" CssClass="EventListDateTV" />
          </c:HorizontalLayout>-->

          <!--<c:HorizontalLine CssClass="EventListLongBreaker" />-->
        </s:If>

        <s:Else>
          <s:If Test="$IsTodayBreakerNeed()">
            <s:Push Id="void" Value="$SetTodayBreakerToFalse()" />
          </s:If>
          <s:Else>
            <!--<c:HorizontalLine CssClass="EventListShortBreaker" />-->
          </s:Else>

          <s:If Test="$IsDateChanged($EventListLastDate, $EventList.startDatePlanDate)">
            <c:HorizontalLine CssClass="EventListLongBreaker" />

            <c:HorizontalLayout CssClass="EventListDateHL">
              <c:TextView Text="$DateTimeToDateWithWeekCheck($EventList.startDatePlanDate)" CssClass="EventListDateTV" />
            </c:HorizontalLayout>

            <c:HorizontalLine CssClass="EventListLongBreaker" />
          </s:If>
        </s:Else>
        <!-- Конец проверки на необходимость плашки с датой и брейкера-->


        <c:HorizontalLayout CssClass="EventListItemHL">

          <c:VerticalLayout CssClass="EventListTimeVL">
            <c:TextView Text="10.00" CssClass="EventListTimeTV" />
            <c:TextView Text="9 мин." CssClass="EventListCounterTV" />
          </c:VerticalLayout>

          <c:VerticalLayout CssClass="EventListStatusVL">
            <c:VerticalLayout CssClass="EventListLineBeforeVL" />
            <c:Image CssClass="EventListStatusIMG" Source="$GetResourceImage(tasklist_done)" />
            <c:VerticalLayout CssClass="EventListLineAfterVL" />
          </c:VerticalLayout>

          <c:VerticalLayout CssClass="EventListDescriptionVL">
            <c:TextView Text="Сбербанк" CssClass="EventListItemName" />
            <c:TextView Text="Петровка" CssClass="EventListItemAddress" />
            <c:TextView Text="Ремонт" CssClass="EventListItemType" />
          </c:VerticalLayout>

        </c:HorizontalLayout>

        <s:Push Id="EventListLastDate" Value="$DateTimeToDate($EventList.startDatePlanDate)" />

      </s:Iterator>
    </c:SwipeVerticalLayout>

  </c:DockLayout>
</c:Screen>